[src.llm.tools] [Tool] trigger_cutscene({'cutscene_type': 'power_awakening', 'motion_prompt': "The camera slowly zooms into Deus's glowing eyes. In the background, the golden rings of light ripple across the sky like water. The wireframe lines of the cathedral pulse with a steady, rhythmic heartbeat of light. The First Mage tips his spectral teacup toward the viewer.", 'image_prompt': 'A cinematic split-screen or layered composition. On one side, the dark, grimy Sewers where DEUS (10-year-old boy) is being carried, his eyes glowing with a calm, crystalline blue. On the other side, the WIREFRAME CATHEDRAL, where a glowing, translucent figure of the FIRST MAGE (generic wizard robes, long beard) sits across from a wireframe projection of Deus. Above them both, a massive pillar of GOLDEN LIGHT erupts from a distant palace, fanning out into concentric rainbow rings across a purple night sky. The mood is one of profound stabilization and hidden triumph.'}) → Cutscene (power_awakening) generation started. It will appear when ready (~30-60s).
[src.media.generator] Location visual saved: C:\Users\admin\Downloads\animerpg\aidm_v3\data\media\1\locations\the_wireframe_cathedral.png
[src.agents.production_tools] Location visual generated for "The Wireframe Cathedral"
[src.media.generator] Cutscene still saved: C:\Users\admin\Downloads\animerpg\aidm_v3\data\media\1\cutscenes\turn15_power_awakening_20260218_144001.png
[src.media.generator] Starting Veo generation (veo-3.1-generate-preview)...
[src.media.generator] Video generation failed: from_bytes
[src.media.generator] Cutscene power_awakening: status=partial, cost=$0.03
[src.core._background] HYBRID TRIGGER at turn 15: ["events:['level_up', 'sakuga_moment']", 'max_interval']
[api.routes.game.session_zero] Phase sync: media_detection -> calibration
[src.agents.profile_generator] DEBUG: research.raw_content is PRESENT
[src.agents.profile_generator] [ProfileGenerator] Large content (2148589 chars) — skipping repetition checks, checking for leaked reasoning only...
[src.agents.profile_generator] [ProfileGenerator] Large content validation passed.
[src.agents.profile_generator] Coverage OK — 7 page types: ['arcs', 'characters', 'factions', 'items', 'locations', 'lore', 'techniques']
[src.agents.profile_generator] Stored 329 pages in LoreStore for hellsing
[src.agents.profile_generator] Ingested lore for hellsing into RAG.
[src.agents.profile_generator] Saved profile hellsing.yaml with lore
[src.agents.profile_generator] DEBUG: research.raw_content is PRESENT
[src.agents.profile_generator] [ProfileGenerator] Large content (1225757 chars) — skipping repetition checks, checking for leaked reasoning only...
[src.agents.profile_generator] [ProfileGenerator] Large content validation passed.
[src.agents.profile_generator] Coverage OK — 7 page types: ['arcs', 'characters', 'factions', 'items', 'locations', 'lore', 'techniques']
[src.agents.profile_generator] Stored 237 pages in LoreStore for hellsing
[src.agents.profile_generator] Ingested lore for hellsing into RAG.
[src.agents.profile_generator] Saved profile hellsing.yaml with lore
WARNING:  WatchFiles detected changes in 'tmp_baseline\src\scrapers\cache.py', 'tmp_baseline\tests\verify_npcs.py', 'tmp_baseline\src\agents\production_tools.py', 'tmp_baseline\src\agents\outcome_judge.py', 'tmp_baseline\src\profiles\loader.py', 'tmp_baseline\src\scrapers\anilist.py', 'tmp_baseline\src\utils\source_trust.py', 'tmp_baseline\src\media\generator.py', 'tmp_baseline\src\db\session_store.py', 'tmp_baseline\tests\test_research.py', 'tmp_baseline\src\scrapers\fandom.py', 'tmp_baseline\tests\test_deathnote.py', 'tmp_baseline\tests\test_core_loop.py', 'tmp_baseline\src\scrapers\wiki_scout_tools.py', 'tmp_baseline\src\settings\models.py', 'tmp_baseline\tests\test_profile_gen2.py', 'tmp_baseline\api\routes\research.py', 'tmp_baseline\src\agents\director.py', 'tmp_baseline\src\agents\director_tools.py', 'tmp_baseline\src\llm\tools.py', 'tmp_baseline\src\scrapers\wiki_scout.py', 'tmp_baseline\tests\stress_test_gameplay.py', 'tmp_baseline\src\settings\crypto.py', 'tmp_baseline\tests\test_foreshadowing_persistence.py', 'tmp_baseline\tests\test_websearch.py', 'tmp_baseline\src\core\dice.py', 'tmp_baseline\src\utils\title_utils.py', 'tmp_baseline\src\agents\profile_merge.py', 'tmp_baseline\src\agents\production_agent.py', 'tmp_baseline\lore_cli.py', 'tmp_baseline\src\main.py', 'tmp_baseline\src\db\models.py', 'tmp_baseline\src\core\state_transaction.py', 'tmp_baseline\src\media\__init__.py', 'tmp_baseline\tests\test_gameplay_tools.py', 'tmp_baseline\src\agents\anime_research.py', 'tmp_baseline\src\llm\anthropic_provider.py', 'tmp_baseline\src\settings\__init__.py', 'tmp_baseline\src\core\session.py', 'tmp_baseline\tests\test_profile_flow.py', 'tmp_baseline\src\scrapers\wiki_normalize.py', 'tmp_baseline\src\context\rule_library.py', 'tmp_baseline\src\core\foreshadowing.py', 'tmp_baseline\src\agents\compactor.py', 'tmp_baseline\src\agents\__init__.py', 'tmp_baseline\src\settings\store.py', 'tmp_baseline\tests\__init__.py', 'tmp_baseline\src\agents\combat.py', 'tmp_baseline\api\main.py', 'tmp_baseline\tests\test_director.py', 'tmp_baseline\src\scrapers\__init__.py', 'tmp_baseline\tests\test_alias_matching.py', 'tmp_baseline\src\scrapers\lore_store.py', 'tmp_baseline\api\routes\settings.py', 'tmp_baseline\api\routes\__init__.py', 'tmp_baseline\src\core\session_export.py', 'tmp_baseline\src\context\memory.py', 'tmp_baseline\src\llm\__init__.py', 'tmp_baseline\src\settings\defaults.py', 'tmp_baseline\tests\debug_pipeline.py', 'tmp_baseline\src\utils\__init__.py', 'tmp_baseline\tests\test_wiki_relevance.py', 'tmp_baseline\src\agents\extraction_schemas.py', 'tmp_baseline\tests\compare_profiles.py', 'tmp_baseline\src\agents\context_selector.py', 'tmp_baseline\src\agents\validator.py', 'tmp_baseline\tests\stress_test.py', 'tmp_baseline\tests\test_handoff.py', 'tmp_baseline\tests\debug_orchestrator.py', 'tmp_baseline\src\agents\relationship_analyzer.py', 'tmp_baseline\src\media\resolver.py', 'tmp_baseline\src\profiles\__init__.py', 'tmp_baseline\src\agents\world_builder.py', 'tmp_baseline\src\core\turn.py', 'tmp_baseline\src\agents\progression.py', 'tmp_baseline\src\llm\provider.py', 'tmp_baseline\src\agents\scope.py', 'tmp_baseline\src\db\session.py', 'tmp_baseline\src\db\__init__.py', 'tmp_baseline\src\core\__init__.py', 'tmp_baseline\tests\test_narrative_diversity.py', 'tmp_baseline\src\db\state_manager.py', 'tmp_baseline\api\__init__.py', 'tmp_baseline\src\agents\memory_ranker.py', 'tmp_baseline\tests\test_profile_gen.py', 'tmp_baseline\src\agents\pacing_agent.py', 'tmp_baseline\src\agents\override_handler.py', 'tmp_baseline\src\agents\intent_classifier.py', 'tmp_baseline\src\agents\gameplay_tools.py', 'tmp_baseline\src\agents\session_zero.py', 'tmp_baseline\src\agents\scale_selector.py', 'tmp_baseline\src\agents\recap_agent.py', 'tmp_baseline\src\llm\manager.py', 'tmp_baseline\src\agents\profile_generator.py', 'tmp_baseline\src\core\session_manager.py', 'tmp_baseline\tests\test_arifureta.py', 'tmp_baseline\src\context\custom_profile_library.py', 'tmp_baseline\api\routes\game.py', 'tmp_baseline\src\utils\power_utils.py', 'tmp_baseline\src\__init__.py', 'tmp_baseline\run_server.py', 'tmp_baseline\src\agents\key_animator.py', 'tmp_baseline\src\agents\progress.py', 'tmp_baseline\src\llm\google_provider.py', 'tmp_baseline\src\context\profile_library.py', 'tmp_baseline\src\llm\openai_provider.py', 'tmp_baseline\src\core\orchestrator.py', 'tmp_baseline\tests\test_hellsing.py', 'tmp_baseline\tests\phase4_checks.py', 'tmp_baseline\tests\test_deferred_commit.py', 'tmp_baseline\tests\test_orchestrator.py', 'tmp_baseline\src\agents\base.py', 'tmp_baseline\src\config.py'. Reloading...
WARNING:  WatchFiles detected changes in 'tmp_baseline\src\scrapers\cache.py', 'tmp_old_sz_feb13.py', 'tmp_baseline\tests\verify_npcs.py', 'tmp_baseline\src\agents\production_tools.py', 'tmp_baseline\src\core\session_manager.py', 'tmp_baseline\src\agents\outcome_judge.py', 'tmp_baseline\src\utils\source_trust.py', 'tmp_baseline\src\media\generator.py', 'tmp_baseline\src\db\session_store.py', 'tmp_baseline\src\scrapers\anilist.py', 'tmp_baseline\src\scrapers\fandom.py', 'tmp_baseline\tests\test_core_loop.py', 'tmp_baseline\src\scrapers\wiki_scout_tools.py', 'tmp_baseline\src\settings\models.py', 'tmp_baseline\tests\test_profile_gen2.py', 'tmp_baseline\api\routes\research.py', 'tmp_baseline\src\agents\director.py', 'tmp_baseline\src\agents\director_tools.py', 'tmp_baseline\src\llm\tools.py', 'tmp_baseline\src\settings\crypto.py', 'tmp_baseline\tests\stress_test_gameplay.py', 'tmp_baseline\src\scrapers\wiki_scout.py', 'tmp_baseline\tests\test_foreshadowing_persistence.py', 'tmp_baseline\tests\test_websearch.py', 'tmp_baseline\src\core\dice.py', 'tmp_baseline\src\utils\title_utils.py', 'tmp_baseline\src\agents\profile_merge.py', 'tmp_baseline\src\agents\production_agent.py', 'tmp_baseline\lore_cli.py', 'src\agents\session_zero.py', 'tmp_baseline\src\main.py', 'tmp_baseline\src\db\models.py', 'tmp_baseline\src\core\state_transaction.py', 'tmp_baseline\src\media\__init__.py', 'tmp_baseline\tests\test_gameplay_tools.py', 'tmp_baseline\src\agents\anime_research.py', 'tmp_baseline\src\llm\anthropic_provider.py', 'tmp_baseline\src\settings\__init__.py', 'tmp_baseline\tests\test_research.py', 'tmp_baseline\src\core\session.py', 'tmp_baseline\tests\test_profile_flow.py', 'tmp_baseline\src\scrapers\wiki_normalize.py', 'tmp_baseline\src\context\rule_library.py', 'tmp_baseline\src\core\foreshadowing.py', 'tmp_baseline\src\agents\compactor.py', 'tmp_baseline\src\agents\__init__.py', 'tmp_baseline\tests\__init__.py', 'tmp_baseline\src\agents\combat.py', 'tmp_baseline\src\profiles\loader.py', 'tmp_baseline\tests\test_director.py', 'tmp_baseline\api\main.py', 'tmp_baseline\src\scrapers\__init__.py', 'tmp_baseline\tests\test_alias_matching.py', 'tmp_baseline\src\scrapers\lore_store.py', 'tmp_baseline\api\routes\settings.py', 'tmp_baseline\api\routes\__init__.py', 'tmp_baseline\src\core\session_export.py', 'tmp_baseline\src\context\memory.py', 'tmp_baseline\src\llm\__init__.py', 'tmp_baseline\src\settings\defaults.py', 'tmp_baseline\tests\debug_pipeline.py', 'tmp_baseline\tests\test_deathnote.py', 'tmp_baseline\src\utils\__init__.py', 'tmp_baseline\src\agents\extraction_schemas.py', 'tmp_baseline\tests\test_wiki_relevance.py', 'tmp_baseline\tests\compare_profiles.py', 'tmp_baseline\src\agents\context_selector.py', 'tmp_baseline\src\agents\validator.py', 'tmp_baseline\tests\stress_test.py', 'tmp_baseline\tests\test_handoff.py', 'tmp_baseline\tests\debug_orchestrator.py', 'tmp_baseline\src\agents\world_builder.py', 'tmp_baseline\src\media\resolver.py', 'tmp_baseline\src\agents\relationship_analyzer.py', 'tmp_baseline\src\profiles\__init__.py', 'tmp_baseline\src\core\turn.py', 'tmp_baseline\src\agents\progression.py', 'tmp_baseline\src\llm\provider.py', 'tmp_baseline\src\agents\scope.py', 'tmp_baseline\src\db\session.py', 'tmp_baseline\src\db\__init__.py', 'tmp_baseline\src\core\__init__.py', 'tmp_baseline\tests\test_narrative_diversity.py', 'tmp_baseline\api\__init__.py', 'tmp_baseline\src\db\state_manager.py', 'tmp_baseline\src\agents\memory_ranker.py', 'tmp_baseline\tests\test_profile_gen.py', 'tmp_baseline\src\agents\pacing_agent.py', 'tmp_baseline\src\agents\override_handler.py', 'tmp_old_sz.py', 'tmp_baseline\src\agents\gameplay_tools.py', 'tmp_baseline\src\agents\session_zero.py', 'tmp_baseline\src\agents\scale_selector.py', 'tmp_baseline\src\agents\intent_classifier.py', 'tmp_baseline\src\agents\recap_agent.py', 'tmp_baseline\src\agents\profile_generator.py', 'tmp_baseline\src\llm\manager.py', 'tmp_baseline\tests\test_arifureta.py', 'tmp_baseline\src\context\custom_profile_library.py', 'tmp_baseline\api\routes\game.py', 'tmp_baseline\src\utils\power_utils.py', 'tmp_baseline\src\__init__.py', 'tmp_baseline\run_server.py', 'tmp_baseline\src\agents\key_animator.py', 'tmp_baseline\src\agents\progress.py', 'tmp_baseline\src\llm\google_provider.py', 'tmp_baseline\src\context\profile_library.py', 'tmp_baseline\src\llm\openai_provider.py', 'tmp_baseline\src\core\orchestrator.py', 'tmp_baseline\tests\test_hellsing.py', 'tmp_baseline\tests\phase4_checks.py', 'tmp_baseline\tests\test_deferred_commit.py', 'tmp_baseline\tests\test_orchestrator.py', 'tmp_baseline\src\agents\base.py', 'tmp_baseline\src\settings\store.py', 'tmp_baseline\src\config.py'. Reloading...
[api.routes.game.session_zero] Phase sync: media_detection -> calibration
[src.agents.profile_generator] DEBUG: research.raw_content is PRESENT
[src.agents.profile_generator] [ProfileGenerator] Large content (1691252 chars) — skipping repetition checks, checking for leaked reasoning only...
[src.agents.profile_generator] [ProfileGenerator] Large content validation passed.
[src.agents.profile_generator] Coverage OK — 7 page types: ['arcs', 'characters', 'factions', 'items', 'locations', 'lore', 'techniques']
[src.agents.profile_generator] Stored 294 pages in LoreStore for hellsing
[src.agents.profile_generator] Ingested lore for hellsing into RAG.
[src.agents.profile_generator] Saved profile hellsing.yaml with lore
[api.routes.game.session_zero] Queued player character media generation
[api.routes.game.session_zero] Generating opening scene server-side...
[src.media.generator] Model sheet saved: C:\Users\admin\Downloads\animerpg\aidm_v3\data\media\1\models\adam_archaeon_model.png
[src.media.generator] Portrait saved: C:\Users\admin\Downloads\animerpg\aidm_v3\data\media\1\portraits\adam_archaeon_portrait.png
[api.routes.game.session_mgmt] [Handoff→Media] Player portrait saved: /api/game/media/1/portraits/adam_archaeon_portrait.png
[api.routes.game.session_mgmt] [Handoff→Media] Player model sheet saved: /api/game/media/1/models/adam_archaeon_model.png
[src.core._turn_pipeline] Recap generated: 590 chars
